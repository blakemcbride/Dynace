@c -*-texinfo-*-

@c  Copyright (c) 1996 Blake McBride
@c  All rights reserved.
@c
@c  Redistribution and use in source and binary forms, with or without
@c  modification, are permitted provided that the following conditions are
@c  met:
@c
@c  1. Redistributions of source code must retain the above copyright
@c  notice, this list of conditions and the following disclaimer.
@c
@c  2. Redistributions in binary form must reproduce the above copyright
@c  notice, this list of conditions and the following disclaimer in the
@c  documentation and/or other materials provided with the distribution.
@c
@c  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
@c  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
@c  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
@c  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
@c  HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
@c  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
@c  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
@c  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
@c  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
@c  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
@c  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

@chapter Mechanics
@pdfchapter{Mechanics}

This chapter, in concert with the WDS examples, describes the tools and
actual steps necessary to create WDS application programs.  The best
method of learning is to go through the example programs located under
the @code{\DYNACE\WINEXAM} directory in the order in which they appear.

@section Build Modes
@pdfsection{Build Modes}
There are two principal modes of building WDS applications.  You can
either use the Integrated Development Environment (IDE) which comes
with your compiler or you can use the included DMAKE command line
make utility along with the other command line facilities of your
compiler.

Use of the IDE is recommended since it provides a convenient environment
for editing, building, debugging and executing your application.  However,
the DMAKE method is required both for building the WDS libraries from
scratch (if you have the source edition) or to build WDS applications
which contain new Dynace classes.  This is required because the build
procedure necessary for Dynace classes is too complex for the IDEs.

Note, however, that creating new Dynace classes is not required in
order to build full featured WDS applications.

In addition, only the DMAKE mode is supported when initially building
the Dynace and WDS systems from scratch.


@section IDE Build Setup
@pdfsection{IDE Build Setup}
Prior to building any of the examples using the IDE, a few configuration
options within the IDE need to be set.

@subsection Microsoft IDE
@pdfsubsection{Microsoft IDE}
Configure the correct directories for include files and libraries.
This can be done via the tools / options / directories menu item.

Configure the IDE such that it will look under the
@code{\DYNACE\INCLUDE} directory (in addition to whatever is already
set) for include files.

Additionally, configure the IDE such that it
will look under the @code{\DYNACE\LIB} directory (in addition to
whatever is already set) for library files.


@subsection Borland IDE
@pdfsubsection{Borland IDE}
Configure the correct directories for include files and libraries.
Since the Borland IDE associates these directories directly with
each project, this information will have to be adjusted separately
for each of the two @code{.IDE} files which come with Dynace.
These files are under the @code{\DYNACE\WINEXAM\SETUP} directory
and are called @code{WIN16.IDE} and @code{WIN32.IDE}.
This can be done via the options / project / directories menu item
after loading one of the @code{IDE} files.  You must then save the
change by using the project / close project menu option.  Repeat this
procedure for both @code{IDE} files.

Configure the IDE such that it will look under the
@code{\DYNACE\INCLUDE} directory (in addition to whatever is already
set) for include files.

Additionally, configure the IDE such that it will look under the
@code{\DYNACE\LIB} directory (in addition to whatever is already set)
for library files.

@subsection Symantec IDE
@pdfsubsection{Symantec IDE}
Symantec compiler versions 7.2 and prior do not work due to bugs in
their compiler.  A patched 7.2 compiler did work but was a little
flaky.  Version 7.21 seemed to work fine but was not extensively
tested.

@section DMAKE Build Setup
@pdfsection{DMAKE Build Setup}
This section lists environment variables which must be set if the
DMAKE build mode is used.  If the IDE build mode is used
see the IDE Build Setup section for setup details.

The @code{\DYANCE\BIN} directory should be part of the search path used
by your system for executable programs (the @code{PATH} environment
variable).

The following environment variables should be set as follows (modify as
appropriate):
@example
@group
set MAKESTARTUP=c:\dynace\utils\startup.mk
set TMPDIR=c:\tmp
set DOS4G=quiet
set DOS16M=:4M
@end group
@end example

The @code{DOS4G} and @code{DOS16M} environment variables are only necessary
when running the 32 bit DOS version of @code{dpp.exe} which has been
compiled with the WATCOM compiler.  Win32 or other versions of @code{dpp}
do not require these variables.

Although not required by the example programs, Microsoft users may find
it convenient to add @code{\DYNACE\INCLUDE} and @code{\DYNACE\LIB} to
your compiler's include and library search paths respectively.

Borland users will need to adjust the @code{BORLAND_HOME} path setting
in the @code{B16.DM} and @code{B32.DM} makefiles located in the
@code{\DYNACE\WINEXAM\SETUP} and Dynace source code directories.  In
addition, the Borland resource compiler requires that the @code{INCLUDE}
environment variable be set to where the Borland include files are
located, for example:

@example
set INCLUDE=d:\bc45\include
@end example


@section Building Dynace & WDS From Scratch
@pdfsection{Building Dynace & WDS From Scratch}
The procedure used to build Dynace & WDS from scratch is fully described
in @hfil @break @code{\DYNACE\DOCS\BUILD.txt}.  See that file for build
instructions.

New users will want to read all the files in the @code{docs} directory.


@section Examples Setup
@pdfsection{Examples Setup}
All examples are buildable under all supported environments and build
procedures, including IDE or DMAKE builds, as well as 16 bit Windows or
32 bit Win32 (NT, Win32s, Windows 95).  The only difference is the build
procedures or associated makefiles.

In order to avoid having all supported build procedures cluttering up
the example directories, the example directories are shipped
without any build procedures installed.  All the build procedures
are located in the @code{\DYNACE\WINEXAM\SETUP} directory along
with batch files used to install the specific build procedures you
need.

The following table lists the commands available in order to configure
the example programs.  Note that each command must be executed from the
@code{\DYNACE\WINEXAM\SETUP} directory unless otherwise indicated.
There is no harm in configuring the examples for more than one
configuration at the same time.

@table @asis
@item M16IDE
IDE build with Microsoft Visual C 16 bit

@item M16DM
DMAKE build with Microsoft Visual C 16 bit

@item M32IDE
IDE build with Microsoft Visual C 32 bit

@item M32DM
DMAKE build with Microsoft Visual C 32 bit

@item B16IDE
IDE build with Borland C 16 bit

@item B16DM
DMAKE build with Borland C 16 bit

@item B32IDE
IDE build with Borland C 32 bit

@item B32DM
DMAKE build with Borland C 32 bit

@item S32IDE
IDE build with Symantec C 32 bit

@item S32DM
DMAKE build with Symantec C 32 bit

@item CLEANALL
Used to delete all files produced by builds in all examples

@item REALCLN
Used to delete all files produced by builds and all build configuration
files (basically to go back to an as-shipped state)

@item CLEAN
Used to delete all files produced by a build for a single example
(execute from the particular example's directory)

@end table




@section Example Files
@pdfsection{Example Files}
This section documents the files which are contained in each example
program.

@table @asis
@item README
This file describes the object of the example.  It should be read
first.

@item MAIN.C
This file is the complete source code to the example program.

@item MAIN.TXT
This is a fully commented version of MAIN.C.  It describes all aspects
of the current example which are unique.

@item MAIN.RC
This is the resource script describing the resources used by the application.
It is created and edited via the indigenous resource editor.

@item RESOURCE.H
This is another file created by the resource editor.  It is used by the
application code to associate resources defined in MAIN.RC to macro names.

@item ALGOCORP.ICO
An icon picturing the Algorithms Corporation logo.

@item MAIN.DEF
Link definition file.  Only needed for Windows 3.1 applications.

@end table


In addition to the above, the following build/system specific make or
project files are used.

@table @asis
@item MAIN.MAK
Project file for Microsoft Visual C 16 bit

@item M16.DM
DMAKE makefile for Microsoft Visual C 16 bit

@item WIN32.MAK
Project file for Microsoft Visual C 32 bit

@item M32.DM
DMAKE makefile for Microsoft Visual C 32 bit

@item WIN16.IDE
Project file for Borland C 16 bit

@item B16.DM
DMAKE makefile for Borland C 16 bit

@item WIN32.IDE
Project file for Borland C 32 bit

@item B32.DM
DMAKE makefile for Borland C 32 bit

@item S32.PRJ & S32.OPN
Project files for Symantec C 32 bit
(requires version 7.21 or later)

@item S32.DM
DMAKE makefile for Symantec C 32 bit
(requires version 7.21 or later)

@end table


Once an application is built, the only file needed to run it is
@code{MAIN.EXE}.



@section Building The Examples
@pdfsection{Building The Examples}
In order to build an example with an IDE, simply open the appropriate
project file and select build.

In order to build with the DMAKE command line utility execute the
following command.

@example
dmake -f MAKEFILE.DM
@end example

where @code{MAKEFILE.DM} is one of the DMAKE makefiles listed above.

Alternatively, you can use the following command to create a debug
version of the example:

@example
dmake -f MAKEFILE.DM  DEBUG=1
@end example



@section Debugging With The IDE
@pdfsection{Debugging With The IDE}
Due to the fact that the WDS is the first thing which Windows sees
when it executes an application and the fact that WDS is not shipped
with debugging information, the following procedure will make it
easier to debug your application code.

First compile your application with debugging information.  Then when you
wish to debug the application, set a break point at ``start''.  You
can then debug your application by telling the debugger to run to the first
break point.  You will then see the initial function of your application
and may debug as usual from that point.

If, however, you purchased the WDS source code, you may compile it
with full debugging information and debug through the WDS code
as well as your application specific code.


@section Building Your Own Application
@pdfsection{Building Your Own Application}
The best method of building your own application would be to start
with one of the example programs and proceed from there.  This way
all the compiler, linker and other options will be preset.  

If you plan to create your own Dynace classes along with your WDS
application, it would be best for you to start with the WDS example
which illustrates the creation of a Dynace class along with the WDS
application.  This example has the appropriate make file logic to
handle custom classes along with a WDS application.

@section DMAKE
@pdfsection{DMAKE}
DMAKE is a very powerful, portable and enhanced make utility developed
by Dennis Vadura.  It is freely distributable and not owned by
Algorithms Corporation or Blake McBride.  Complete documentation for this utility
is contained in @code{\DYNACE\DOCS\DMAKE.MAN}

@section DPP
@pdfsection{DPP}
@code{DPP} is the pre-processor used by Dynace to convert class definition
files into C source files.  It is also used to generate generic files
and perform generic/method argument checking.  This utility is only needed
when creating new classes and is only used by more advanced WDS users
who wish to create their own Dynace classes.

This utility is fully documented in the Dynace language manual.



